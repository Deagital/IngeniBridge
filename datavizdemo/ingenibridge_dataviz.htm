<html>
	<head>
		<script src="Scripts/jquery-3.3.1.js" type="text/javascript"></script>
		<script>
            $(document).ready(function(){
                
                $('#tbDatavizRequest').keyup(function(e)
				{
					tbDatavizRequest_KeyUp();
                })
               
            });
        </script>
		<script>
			function tbDatavizRequest_KeyUp()
			{
				var querytext = $('#tbDatavizRequest').val();
				if ( querytext == "") 
				{
					$('#tbResults').val(null);
					return;
				}
				var urlrest = "http://ingenibridgedemo.azurewebsites.net/REQUESTER/RetrieveDatavizTimeSeries?SearchString=" + querytext;
				$('#lblUrl').val(urlrest);
				$('#lblUrl').attr("href",urlrest);
				$(document).ready(function () {
					$.ajax(
					{
						type: 'GET',
						url: urlrest,
						cache: false,
						beforeSend: function (jqXHR, settings) 
						{
							jqXHR.setRequestHeader('Access-Control-Allow-Origin', '*');
							jqXHR.setRequestHeader('authority', 'ingenibridgedemo.azurewebsites.net');
							jqXHR.setRequestHeader('upgrade-insecure-requests', '1');
						},
						crossDomain: true,
						dataType: 'json',
						contentType: "application/json",
						error: function (e)
						{
							$('#tbResults').val("error");
						},
						success: function (data)
						{
							var nbresults = 0;
							var items = [];
							$.each(data.values, function(index, element) 
							{
								items.push(element.DatavizTimeSeriesDescription);
								items.push(element.TimeSeriesExternalReference);
								nbresults = nbresults + 1
							});
							$('#tbResults').val(items);
							$('#lblNbResults').val(nbresults);
						}
					});
				});
			}

		</script>
	</head>
	<body>
		<input id="tbDatavizRequest" type="text" />
		<input id="tbResults" type="text"></input>
		<label id="lblNbResults" type="text"></label>
		<label id="lblUrl" href="" type="text">...</label>
	</body>
</html>